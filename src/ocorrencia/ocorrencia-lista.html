<div class="card">
  <div class="card-body p-0">

    <h4 class="card-title m-4">OCORRÊNCIAS
      <div class="text-right">
        <button type="button" class="btn btn-success btn-sm" ng-click="vm.abrirModal()" ng-if="usuario.flagFiscal">
          Adicionar
          <i class="icon-plus ml-1"></i>
        </button>
        <button type="button" class="btn btn-outline-info btn-sm" ng-click="vm.exportar()">
          Exportar
          <i class="icon-cloud-download ml-1"></i>
        </button>
      </div>
    </h4>

    <uib-accordion class="accordion accordion-solid-header accordion-custom">
      <div uib-accordion-group is-open="vm.isFilterOpen">
        <uib-accordion-heading>
          Filtros de busca
        </uib-accordion-heading>
        <form novalidate autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
          <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-2 my-2">
              <div class="form-control">
                <label for="dataInicial" class="dois-pontos">Data Inicial</label>
                <input type="text" class="form-control lh-18" id="dataInicial" ng-model="vm.filtros.dataInicial"
                  uib-datepicker-popup="dd/MM/yyyy" datepicker-options="vm.optionsDatePickerFiltro" is-open="focus1"
                  ng-focus="focus1=true">
              </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2 my-2">
              <div class="form-control">
                <label for="dataFinal" class="dois-pontos">Data Final</label>
                <input type="text" class="form-control lh-18" id="dataFinal" ng-model="vm.filtros.dataFinal"
                  uib-datepicker-popup="dd/MM/yyyy" datepicker-options="vm.optionsDatePickerFiltro" is-open="focus2"
                  ng-focus="focus2=true">
              </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2 my-2">
              <div class="form-control">
                <label for="encerrado" class="dois-pontos">Encerrado</label>
                <select class="form-control" id="encerrado" ng-model="vm.filtros.flagEncerrado">
                  <option value="" selected>Todos</option>
                  <option value="true">Sim</option>
                  <option value="false">Não</option>
                </select>
              </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2 my-2" ng-if="usuario.usuarioOrigem.codigo === 'sme'">
              <div class="form-control">
                <label for="encerrado" class="dois-pontos">Situação</label>
                <select class="form-control" id="encerrado" ng-model="vm.filtros.flagSomenteAtivos">
                  <option value="true" selected>Somente Ativos</option>
                  <option value="false">Somente Excluídos</option>
                </select>
              </div>
            </div>
            <div class="col-sm-12 col-md-6 my-2"
              ng-class="usuario.usuarioOrigem.codigo === 'sme' ? 'col-lg-4' : 'col-lg-6'">
              <div class="form-control">
                <label for="ue" class="dois-pontos">Variável Gerencial</label>
                <select class="form-control" id="ue" ng-model="vm.filtros.idOcorrenciaTipo"
                  ng-options="ot.id as ot.descricao for ot in vm.idOcorrenciaTipoList">
                  <option value="" selected>Todos</option>
                </select>
              </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-4 my-2" ng-if="usuario.usuarioOrigem.codigo !== 'ps'">
              <div class="form-control">
                <label for="ps" class="dois-pontos">Prestador de Serviço</label>
                <ui-select id="ps" ng-model="vm.filtros.prestadorServico">
                  <ui-select-match allow-clear="true"
                    placeholder="Todos">{{$select.selected.descricao}}</ui-select-match>
                  <ui-select-choices repeat="ps in vm.prestadorServicoList | filter: $select.search">
                    <span class="mb-0 d-block" ng-bind-html="ps.razaoSocial | highlight: $select.search"></span>
                    <small class="my-2">CNPJ:</small>
                    <small class="my-2" ng-bind-html="(ps.cnpj | brCnpj) | highlight: $select.search"></small>
                  </ui-select-choices>
                </ui-select>
              </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6 my-2" ng-if="usuario.usuarioOrigem.codigo === 'sme'">
              <div class="form-control">
                <label for="contrato" class="dois-pontos">Contrato</label>
                <ui-select id="contrato" ng-model="vm.filtros.contrato">
                  <ui-select-match allow-clear="true" placeholder="Todos">
                    {{$select.selected.codigo}} - {{$select.selected.descricao}}
                  </ui-select-match>
                  <ui-select-choices repeat="contrato in vm.contratoLista | filter: $select.search">
                    <span class="mb-0 d-block" ng-bind-html="contrato.descricao | highlight: $select.search"></span>
                    <small class="my-2">Código:</small>
                    <small class="my-2" ng-bind-html="contrato.codigo | highlight: $select.search"></small>
                  </ui-select-choices>
                </ui-select>
              </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2 my-2">
              <div class="form-control">
                <label for="respondido" class="dois-pontos">Respondido</label>
                <select class="form-control" id="respondido" ng-model="vm.filtros.respondido">
                  <option value="" selected>Todos</option>
                  <option value="true">Sim</option>
                  <option value="false">Não</option>
                </select>
              </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-12 my-2" ng-if="usuario.usuarioOrigem.codigo !== 'ue'">
              <div class="form-control">
                <label for="eu" class="dois-pontos">Unidade Escolar</label>
                <ui-select id="eu" name="turnoList" ng-model="vm.filtros.unidadeEscolar" class="form-control" multiple>
                  <ui-select-match placeholder="Todos">
                    {{$item.codigo}} - {{$item.descricao}}
                  </ui-select-match>
                  <ui-select-choices repeat="ue in vm.unidadeEscolarList | filter: $select.search track by ue.codigo">
                    <span class="mb-0 d-block" ng-bind-html="ue.descricao | highlight: $select.search"></span>
                    <small class="my-2" ng-bind-html="ue.codigo | highlight: $select.search"></small>
                    <small class="my-2"> - </small>
                    <small class="my-2" ng-bind-html="ue.tipo | highlight: $select.search"></small>
                  </ui-select-choices>
                </ui-select>
              </div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-4">
              <button type="button" class="btn btn-primary" ng-click="vm.recarregarTabela()">Filtrar</button>
            </div>
          </div>
        </form>
      </div>
    </uib-accordion>

    <div class="row">
      <div class="col-12">
        <lista></lista>
      </div>
    </div>

  </div>
</div>